<section class="new-arrivals">
    <div class="new-arrivals-header">
        <div class="header-left">
            <h2 class="section-title"><span>New</span> Arrivals</h2>
            <p class="section-subtitle">Shop online for new arrivals and get free shipping!</p>
        </div>
    
        <div class="header-right">
            <div class="category-filters" id="category-container">
                <ul>
                    <li class="active">All</li>
                    <li>Cakes</li>
                    <li>Cupcakes & Muffins</li>
                    <li>Pies & Tarts</li>
                    <li>Desserts</li>
                    <li>Croissant</li>
                    <li>Snacks</li>
                    <li>Food Menu</li>
                    <li>Beverages</li>
                </ul>
            </div>
        </div>
    </div>
    

    <div class="product-grid" id="products-container">
        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/45a5/b7c7/495c436c36424bfee5a0384fa68331fa?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=qdDBiU8FClumOXSW7aRdSkE3vMcXBwknkRAm5AF0kF9SbtyxoVI5fVW01A03M7mBBPYeXYSAeRGgA5GGl69YGqX14DgA0LjYU-uJ790XtPrjX6ljncUltu6oPys4xjk0O8CVXXYcLbvR0NqElMDuNH4lhS85jYXjsCwLfPC5G5DQWkw8Wqvz5kN2MtWcXQwmiiwqYfnZ3eXGEOxF5BLsfo6g5lU2PLItEF7g-0pdq9yImEnR2MMZY4ZDRPrPpVg6Pc0Tubx53tcY9P3RjU2gJVV6vvC6eLBJ18eA1IMyArozke9BqTBhXJ31yH0dbptwLTUfcrfVuiKcXouVz-IIzA__" alt="Blueberry Cheesecake">
            <div class="product-info">
                <span class="category">Cakes</span>
                <h3>BLUEBERRY CHEESE CAKE</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ200.00 <span>1 Slice</span></p>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/862d/44e0/061e29c6e50f12618b0ba34042f3fd79?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=cG-mcU7qlmsC6EH3ElXgE0f-8-RUKi7-HLfx8lxLgViTNAyNU3-0q9cywKfziETo5pwYcuDbxETJQGpeqwTDmqbH003CUDfQhjr7yWnHS-HuHIbxJDWNEW6xPk6ZdWWKQ~CtXFsn4rzhWkvGSifZgMJZ6gLN8S5eL6W28eduUDcPoV1NrQjgFReX9f0Q8TGrtJCzZdhMiKcJ~Zj3mOO7KCJiKGmmzFcUgY~CzLFfrwWgNJpF3cBlt7Od8EVfRB14yPeXMfFQmTXJRF1Oq5pGIXWsDGOShaQQWXrotf8J2Uym0SKXwVRTQmOFQz-yqeuPrtHBRpJ9iSB-mRNa83AttA__" alt="Triple Chocolate Mousse Cake">
            <div class="product-info">
                <span class="category">Cakes</span>
                <h3>TRIPLE CHOCOLATE MOUSSE CAKE</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ260.00</p>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/0406/0f5e/2352a86563a173ec4d68f918cc3d72ff?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=Vgd54yRnBTopaZFrVWD153rhTK6VUkmfw1t5~tuOrXcvBc92Ny8X-uVw~XD3P1Sj5cFOhADStK15g3KCSl~XZdAhcy-1d9eSujQvfbo0Lh8QCORQZQ2F2hudRzvifSSZ0zYjUDrVbUYisj0EX5Jjj1MvnLldcB6HyKUMNlxn7ZB~urqKQEaFkLb1uUU7yom8XtYELfwryodi-JVEqczFExdNiGG0KLeECroynepgTp2BlX8e-8CvVJqm1ppHJb6liDEqV1P70Q3Fhwyyt2nFM-UFlrvP3asLOiZ704spj1J45FGt3hFDWzaZs4SYLq3gWelhAYgWcpaRvdPcgSqNiQ__" alt="Motichoor Rabdi Mousse Cake">
            <div class="product-info">
                <span class="category">Cakes</span>
                <h3>MOTICHOOR RABDI MOUSSE CAKE</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ65.00 <del>‚Çπ46.00</del></p>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/8858/3ff8/f78492380cd2d687ad0d23afeb0d5a70?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=T9yD3GQKMYbb2Af0qck9WBpbb8F2VDFsQ1qXbT1iIPlLRtkWmclPZeOQyeD539Vl1KyOsNybmx0LgE0NJzdoEGjume395oMDVcm7x3O1nZE~IuGMPudTlkUbgFL~35~3EDeilS-pqQaGcV7NL9JdDOxwFZlBoggL1CG9J5v4hBEiCQ90SE6QMbdmVEZ0KQh6wURPY5yylCqqV9UjJWl0kuTbENI-tTRvAISvHksq6hcoLIZEhpxFJLdk9R768vaS01DSWHfX~HJHMkPl6hySN9oHY0oTvsJv5IZF3mfkiOSFneltO~D62e8nnL4-YXDKewMHlXEwVEL4Ukz7MKrUwQ__" alt="Double Chocolate Cupcake">
            <div class="product-info">
                <span class="category">Cupcakes & Muffins</span>
                <h3>DOUBLE CHOCOLATE CUP CAKE</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ70.00 <del>‚Çπ80.00</del></p>
                <span class="badge sale">SALE</span>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/6ecd/8944/d2f2cc6ae3dd16cb9a679827cc4e221d?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=UvSaU4P6gYTnPFJMwyb8spSJplpKUkG9BM83J66kjX6QyYe3xN6U-E-~jXBx9-f5wfci0ZPLs-2T63zxqTpto3W8Cz1UFzKwVb69iZu1DCgHre76LMgo0Ti4Gvav9cKDKZut47JZX2JISG~9giCAEL1wqWibx24Gg3IXS4ZQH0a6qyqU7oJLvnzpF4QYuISJUE0WwXEyGJY-3Wbx5XQu6-ejtU3djQ6W493baGJkTPQA9lxl0gAb7jl0~jnnAMYDntPeigEz3-cW~DSeed7MF1LgC68KjbbB1Lx~V80jIglHNU5NOW7WglI-beNz447WzTLZGfsrdlTWKrm0ALhDmA__" alt="Tandoori Veggie Sandwich">
            <div class="product-info">
                <span class="category">Snacks</span>
                <h3>TANDOORI VEGGIE SANDWICH</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ150.00</p>
                <span class="badge new">NEW</span>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/373e/b1e7/89a86fc31af1530bc438e04c287d18a6?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=dFd9ygij6CM6j3ECzk8kAKgMx-7OhZW~QhkUK~xTiORFSCgFbgoFINJJvx28m0k7QXiom6TD3mFPAh2cDM4Y6jgbgOSC5j4F536~XOOBWLmkn-KxNq7uwJdap5W-ZGTDut6LedP0t5NGfovkG2~rBc8iEhA4T2Z0hmQ-qY9SXNKIS-q6WpB6JpBx1mpCJ8eiEzlUx1X7aOgGhM1snmFmKuMsKRIf4Gqr~1v9OjVXr-oDjc5k6NP4NADL0PoU7hYAUpZMRfcS0Ksy2CSIxJ7XDewvKegZXIlamzj~1covUI0mFdopU~wRiEUln-IelfEJsf51a9Q6zzA2zZ-f1eginQ__" alt="Red Velvet">
            <div class="product-info">
                <span class="category">Cakes</span>
                <h3>RED VELVET</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ700.00 <strike>‚Çπ750.00</strike></p>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/ef04/3dbb/2b7cccec16c019ce86a585e7241463b7?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=DJ562FCnN-yWQ64l24lNAcj8fPbUAgUwgLdMgaFLaMfEyqrtCy7O-q8iGr9Y6Z~bP4egQDJA8EhUEaf2T1OOabx4hEpS2JpK72jkmysv0eYVWoSa0ENnorj~ouV10TkhwCaJ8Kgxs2PV9bgppmVKdezl3sOMtVLlrDKUBQWumUF55COYTbkwvLgm9Pl9xUTQXwUH~my1zs4L937crgOQKxhvikYoLKxYnziBPPQodTyvA9RZaBNNok~GgOU1ZDSTIsLiVOZ7dUuKuJZmoHs4ZH4Vb70cZLs4UILpnKgrsEKxlx-loulQo-X0ZjFoZjG2TXvF24al5cOl5d6kPHV3IQ__" alt="FRENCH VANILLA BOMBOLONI">
            <div class="product-info">
                <span class="category">Desserts</span>
                <h3>FRENCH VANILLA BOMBOLONI</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ200.00</p>
            </div>
        </div>

        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/68c0/c26d/6dfc08adfb8caefdc69e812acc2dd182?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=FQG6NWjMoizR-w5WA~9Qzs3HtXaP~TxKrCFxAQpEq2szUjghl6iBuabGCWssf0Y1od8ZxwXhfT93oH5xgnrLNuHL3pP5NkaGxK6KoGq~gueIg1qLslrRltsY~IEfmAxWhuunLMl2KStkkM034X5nmpWlFDLwPpTNf~FQK8VN64Qadw5MbyYC6SnR~pNJ4qizD4fvppR-RIPlGLcU5I9bLr9T6I9eCuagHQc3k39w7Y7s2SVtBlq2D0H711RXi5euz-r94z7BfHCGib22CJnzbKqiJ-hh0Ml2Olq83GR3D0HE4sDsHXkA8ke5jbUzg1VZ0BlvXiYnyhg~3c~32b2Tng__" alt="Nutella/hazelnut Shake">
            <div class="product-info">
                <span class="category">beverages</span>
                <h3>Nutella/hazelnut Shake</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ280.00</p>
            </div>
        </div>
        <div class="product-card">
            <img src="https://s3-alpha-sig.figma.com/img/d30b/301d/a8fa63ad1559462e999dba9001fb3a98?Expires=1743379200&Key-Pair-Id=APKAQ4GOSFWCW27IBOMQ&Signature=de1T3ln7ta9fwou9bwkzunPm-fsfKkXZRFVjVXB8lhhZ12z6eBCg6AQnM0WGmnytbZh-jrI0FjCdOTOW~aMP9DptG14gXcZCFiNO0tf4wq8MdCTWKrqq3kMeRFY6riCX-8yRkjhwevArr3pBa~5H54UPw90Znu5tONaPGZ~sP5vAMpU5~bKQBLRGMBaK6msHzREHhEyrsc1OQIS25YkbJPu86-ScTi1EEGO0MsT0baEvbf68jsl8V0HGEUXC9XFaGrCZ4kh5YwTmEuGUdRhR-j4NDrf9z9mNIg2Q79HtOouREDtzBwf4iAMquRWBemmq9C50U-9TolG-g8JMVhdgDA__" alt="ALMOND BLISS CROISSANT">
            <div class="product-info">
                <span class="category">Croissant</span>
                <h3>ALMOND BLISS CROISSANT</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ180.00 <strike>‚Çπ200.00</strike></p>
                <span class="badge new">NEW</span>
            </div>
        </div>
        <div class="product-card">
            <img src="" alt="CHOCOLATE HAZELNUT DELIGHT">
            <div class="product-info">
                <span class="category">Croissant</span>
                <h3>CHOCOLATE HAZELNUT DELIGHT</h3>
                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                <p class="price">‚Çπ180.00</p>
                <span class="badge new">NEW</span>
            </div>
        </div>
        <!-- <script>
        document.addEventListener("DOMContentLoaded", async function () {
            try {
                const response = await fetch("http://127.0.0.1:8000/api/products-list/");
                const data = await response.json();
                const products = data.products.products;
        
                const categoryContainer = document.getElementById("category-container");
                const productsContainer = document.getElementById("products-container");
        
                // Function to display products
                function displayProducts(productList) {
                    productsContainer.innerHTML = "";
                    if (productList.length === 0) {
                        productsContainer.innerHTML = "<p>No products found</p>";
                        return;
                    }
        
                    productList.forEach(product => {
                        const productElement = document.createElement("div");
                        const discountedPrice = product.discount_price ? product.price - product.discount_price : product.price;
        
                        productElement.classList.add("product-card");
                        productElement.innerHTML = `
                            <img src="data:image/png;base64,${product.product_images || 'placeholder.jpg'}" alt="${product.name}" />
                            <div class="product-info">
                                <span class="category">${product.category.name}</span>
                                <h3>${product.name}</h3>
                                <div class="rating">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div> 
                                <p class="price">
                                    ‚Çπ${discountedPrice}
                                    ${product.discount_price ? `<strike>‚Çπ${product.price}</strike>` : ''}
                                </p>
                                <span class="badge new">NEW</span>
                            </div>
                        `;
                        productsContainer.appendChild(productElement);
                    });
                }
        
                function filterProducts(category) {
                    if (category === "All") {
                        displayProducts(products);
                    } else {
                        const filteredProducts = products.filter(product => product.category.name === category);
                        displayProducts(filteredProducts);
                    }
                }
        
                categoryContainer.addEventListener("click", function (event) {
                    if (event.target.tagName === "LI") {
                        const selectedCategory = event.target.innerText.trim();
                        document.querySelectorAll("#category-container li").forEach(li => li.classList.remove("active"));
                        event.target.classList.add("active");
                        filterProducts(selectedCategory);
                    }
                });
                displayProducts(products);
            } catch (error) {
                console.error("Error fetching products:", error);
            }
        });
        </script> -->
<script>
document.addEventListener("DOMContentLoaded", async function () {
    const token = sessionStorage.getItem("auth_token");
    try {
        const response = await fetch("/api/products-list/?page=1&pageSize=1000", {
            method: "GET",
            headers: {
                "Authorization": `Bearer ${token}`,
                "Content-Type": "application/json"
            }
        });
        
        const data = await response.json();
        const products = data.products.products;

        const categoryContainer = document.getElementById("category-container");
        const productsContainer = document.getElementById("products-container");

        // Extract unique categories from products
        const uniqueCategories = ["All", ...new Set(products.map(product => product.category.name))];

        // Generate category filters dynamically
        categoryContainer.innerHTML = `<ul>${uniqueCategories.map(cat => `<li>${cat}</li>`).join("")}</ul>`;

        // Ensure "All" is active by default
        const categoryItems = categoryContainer.querySelectorAll("li");
        if (categoryItems.length) {
            categoryItems[0].classList.add("active");
        }

        function encodeProductId(id) {
            // Convert ID to string, pad or salt it if you want a longer encoded result
            const padded = `${id}-piescakes`;
            return btoa(padded);
        }

        // Function to display products
        function displayProducts(productList) {
            productsContainer.innerHTML = "";
            if (productList.length === 0) {
                productsContainer.innerHTML = "<p>No products found</p>";
                return;
            }

            productList.forEach(product => {
                const productElement = document.createElement("div");
                const discountedPrice = product.discount_price ? product.price - product.discount_price : product.price;

                // Convert product created_at date to JavaScript Date object
                const createdAt = new Date(product.created_at);
                const currentDate = new Date();

                // Calculate the difference in days
                const timeDifference = currentDate - createdAt;
                const daysDifference = timeDifference / (1000 * 60 * 60 * 24);

                // Check if the product is within the last 10 days
                const isNew = daysDifference <= 10;

                const encodedId = encodeProductId(product.id); // üîê encoded ID

                productElement.classList.add("product-card");
                productElement.innerHTML = `<div style="border-radius:0px;text-align: left !important;">
                        <a href="product/${encodedId}"><img src="data:image/png;base64,${product.product_images || 'placeholder.jpg'}" alt="${product.name}"/></a>
                        <div class="product-info">
                            <span class="category mb-1" style="text-align: left !important;">${product.category.name}</span>
                            
                            <h4 class="mb-1 product-heading"><a href="product/${encodedId}" style="
                                text-decoration:none;
                                font-size: 14px !important;
                                text-decoration: none !important;
                                font-weight: bold;
                                text-align: left !important;
                                color: #5A3E36;
                                margin: 0;
                            ">${product.name}</a></h4>
                            
                            <div cls="rating mb-1">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
                            
                            <p class="price mb-1">
                                ‚Çπ${discountedPrice}
                                ${product.discount_price ? `<strike>‚Çπ${product.price}</strike>` : ''}
                            </p class="badge">

                            ${isNew ? `<spans>NEW</span>` : ''}
                        </div>
                    </div>
                `;

                productsContainer.appendChild(productElement);
            });
        }

        // Function to filter products by category
        function filterProducts(category) {
            if (category === "All") {
                displayProducts(products);
            } else {
                const filteredProducts = products.filter(product => product.category.name === category);
                displayProducts(filteredProducts);
            }
        }

        // Event delegation for category selection
        categoryContainer.addEventListener("click", function (event) {
            if (event.target.tagName === "LI") {
                const selectedCategory = event.target.innerText.trim();

                // Remove "active" class from all categories
                document.querySelectorAll("#category-container li").forEach(li => li.classList.remove("active"));
                
                // Add "active" class to the clicked category
                event.target.classList.add("active");

                // Filter products based on selected category
                filterProducts(selectedCategory);
            }
        });

        // Display all products by default
        displayProducts(products);
    } catch (error) {
        console.error("Error fetching products:", error);
    }
});

        </script>
    </div>
</section>
